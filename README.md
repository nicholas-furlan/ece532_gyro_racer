# ECE532 Gyro Racer

This repository contains hardware files (Verilog/VHDL source files) and the software project (C/C++ files) for our ECE532 project.

## Project Description
This is a 2D racing game developed on the Nexys 4 DDR FPGA development board. The game utilizes the PMOD gyroscopes and other input methods to control the racing car, providing an immersive gaming experience.

The game supports both single-player and multiplayer modes. In single-player mode, players compete in a time trial to achieve the best lap time, while in multiplayer mode, players can compete against friends.

## Getting Started
### Hardware Requirements
- Nexys 4 DDR FPGA Development Board
- VGA Monitor
- PMOD GYRO (optional, but the key feature of our game)
- USB Keyboard (optional, alternative controller)

### Setup Instructions
0. Clone this repository to your local machine (you may use `git clone --recursive` to clone all the submodules)
1. (optional) Connect the PMOD GYROs to PMOD connectors JA and JC.
2. (optional) Connect USB keyboard to the USB port.
3. Connect a VGA monitor to the VGA port.
4. Power on the Nexys 4 DDR board.
5. Open Project with Vivado 2018.3, run synthesis, implementation, generate bitstream, export hardware, use the generated bitstream to program your board.
6. Launch Xilinx SDK, create a new C++ empty project with BSP package.
7. Copy all files from `software/` to the C++ project.
8. Create a new Run Configuration, Compile and Run in Xilinx SDK.

### How to Play
- In the title screen and settings interface, the on-board buttons can be used for selection
- Select between single-player time trial and multiplayer mode at the title screen
- In the settings interface, you can:
  - Choose your preferred controller (PMOD Gyroscope, on-board buttons, or keyboard)
  - Select the race track
  - Set the number of laps for the race
- In the game, use the specified controller to control the racing car
- Try to complete the race track in the shortest time possible

## Design Tree
```
ece532_gyro_racer/
├── assets/
│   ├── output/ [Header files generated from images]
│   ├── resource/ [Images for characters/tracks/fonts]
│   ├── mp3_conv.py
│   ├── picture_to_header.py
│   ├── tree.py
│   └── wav_to_hex.py
├── docs/ [Documentation of the project]
├── final/
│   └── gyro_racer_proj/
│       ├── gyro_racer.ip_user_files/ [IP user files generated by Vivado]
│       ├── gyro_racer.srcs/
│       │   ├── constrs_1/imports/libs/Nexys-4-DDR-Master.xdc
│       │   └── sources_1/
│       │       ├── bd/
│       │       │   ├── design_1/ [block design <design_1> files]
│       │       │   └── mref/ [block design reference files]
│       │       ├── imports/
│       │       │   ├── audio_module/
│       │       │   │   ├── axis_acker8k.v
│       │       │   │   └── pwm_generator.v
│       │       │   ├── gyro_reader_0325/
│       │       │   │   ├── axes.v
│       │       │   │   ├── gyro_reader_v1_0.v
│       │       │   │   └── gyro_reader_v1_0_S00_AXI.v
│       │       │   ├── pmod_gyro/
│       │       │   │   ├── pmod_gyro_l3g4200d.vhd
│       │       │   │   └── spi_master.vhd
│       │       │   └── sprite_controller/
│       │       │       ├── ctrl.v
│       │       │       ├── sprite_controller.v
│       │       │       ├── sprite_reader.v
│       │       │       └── sprite_writer.v
│       │       └── new/vid_to_vga_mixer.v
│       └── gyro_racer.xpr
├── ip/
│   ├── ip_repo/gyro_reader_1.0/ [IP repository files for custom IP]
│   ├── ip_user_files/
│   └── managed_ip_project/ [managed IP project files]
├── ip_keyboard/axi_ps2_1.0/ [IP repository files for digilent PS/2 IP]
├── software/
│   ├── game/
│   │   ├── data/
│   │   │   ├── bgm.h
│   │   │   ├── luigi__combined.h
│   │   │   ├── map_0.h
│   │   │   ├── map_1.h
│   │   │   ├── map_2.h
│   │   │   ├── mario__combined.h
│   │   │   └── title.h
│   │   ├── car.hpp
│   │   ├── controller.hpp
│   │   ├── game.hpp
│   │   ├── gameend.hpp
│   │   ├── gameoption.hpp
│   │   ├── gameplay.hpp
│   │   ├── gameplaystate.hpp
│   │   ├── gamestart.hpp
│   │   └── map.hpp
│   ├── graphics/
│   │   ├── color/
│   │   │   ├── color.cpp
│   │   │   └── color.hpp
│   │   ├── display/
│   │   │   ├── display.cpp
│   │   │   └── display.hpp
│   │   ├── draw/
│   │   │   ├── draw.cpp
│   │   │   └── draw.hpp
│   │   ├── font/
│   │   │   ├── font.cpp
│   │   │   └── font.hpp
│   │   ├── image/
│   │   │   ├── image.cpp
│   │   │   └── image.hpp
│   │   └── resource/font_map.hpp
│   ├── memory/
│   │   ├── tlsf/ [An referenced open-source implementation of memory pool]
│   │   ├── memory.cpp
│   │   └── memory.hpp
│   ├── platform/
│   │   ├── microblaze/
│   │   │   ├── adma.hpp
│   │   │   ├── button_switch.cpp
│   │   │   ├── button_switch.hpp
│   │   │   ├── gyro.hpp
│   │   │   ├── intc.cpp
│   │   │   ├── intc.hpp
│   │   │   ├── keyboard.hpp
│   │   │   ├── sprite_engine.hpp
│   │   │   ├── timer.hpp
│   │   │   └── vdma.hpp
│   │   ├── disp_man.hpp
│   │   └── fwd.hpp
│   ├── README.txt
│   ├── lscript.ld
│   └── main.cc
├── stash/ [Temporary files during development]
├── README.md
└── tree.txt
```